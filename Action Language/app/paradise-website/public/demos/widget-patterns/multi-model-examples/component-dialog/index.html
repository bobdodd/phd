<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Multi-Model Example: Component-Based Dialog - Paradise Widget Patterns</title>
  <link rel="stylesheet" href="../../css/demo.css">
  <style>
    .example-explanation {
      background: #f0f8ff;
      border-left: 4px solid #0066cc;
      padding: 20px;
      margin: 20px 0;
    }

    .file-structure {
      background: #f8f8f8;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 16px;
      margin: 16px 0;
      font-family: monospace;
      font-size: 14px;
    }

    .file-structure .file {
      padding: 4px 0;
      padding-left: 20px;
    }

    .file-structure .file::before {
      content: "üìÑ ";
      margin-right: 8px;
    }

    .file-structure .hook::before {
      content: "ü™ù ";
      margin-right: 8px;
    }

    .analysis-comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }

    .analysis-box {
      border: 2px solid #ddd;
      border-radius: 8px;
      padding: 16px;
    }

    .analysis-box.traditional {
      border-color: #ff6b6b;
      background: #fff5f5;
    }

    .analysis-box.paradise {
      border-color: #4caf50;
      background: #f1f8f4;
    }

    .false-positive {
      color: #d32f2f;
      font-weight: bold;
    }

    .true-result {
      color: #388e3c;
      font-weight: bold;
    }

    /* Dialog styling */
    .dialog-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .dialog-overlay.visible {
      display: flex;
    }

    .dialog {
      background: white;
      border-radius: 8px;
      padding: 24px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    .dialog-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .dialog-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      padding: 4px 8px;
    }
  </style>
</head>
<body>
  <div class="container">
    <nav class="breadcrumb">
      <a href="../../index.html">Home</a> &gt;
      <a href="#multi-model">Multi-Model Examples</a> &gt;
      <span>Component-Based Dialog</span>
    </nav>

    <header>
      <h1>üéØ Multi-Model Example: Component-Based Dialog</h1>
      <p class="subtitle">Demonstrating React hooks with separated focus management</p>

      <div class="pattern-info">
        <span class="complexity-badge high">React Hooks Architecture</span>
        <span class="wcag-badge">Zero False Positives</span>
      </div>
    </header>

    <section class="example-explanation">
      <h2>üîç The Problem</h2>
      <p>Modern React applications use custom hooks to separate concerns:</p>
      <ul>
        <li><strong>useDialog.js</strong> - Dialog state management (open/close)</li>
        <li><strong>useFocusTrap.js</strong> - Focus trap logic (Tab/Shift+Tab cycling)</li>
        <li><strong>DialogComponent.jsx</strong> - React component using both hooks</li>
      </ul>

      <p><strong>Traditional tools analyzing DialogComponent.jsx:</strong></p>
      <ul>
        <li>‚ùå "Missing focus trap implementation" (FALSE POSITIVE)</li>
        <li>‚ùå "No focus restoration detected" (FALSE POSITIVE)</li>
        <li>The logic EXISTS but is in the custom hooks!</li>
      </ul>

      <p><strong>Paradise's multi-model architecture:</strong></p>
      <ul>
        <li>‚úÖ Analyzes component + both custom hooks together</li>
        <li>‚úÖ Detects focus trap in useFocusTrap.js</li>
        <li>‚úÖ Detects focus restoration in useDialog.js</li>
        <li>‚úÖ Zero false positives for hook-based architecture</li>
      </ul>
    </section>

    <section class="file-structure-section">
      <h2>üìÅ File Structure</h2>
      <div class="file-structure">
        <div>component-dialog/</div>
        <div class="file">index.html (imports React component)</div>
        <div class="hook">useDialog.js (state + focus restoration)</div>
        <div class="hook">useFocusTrap.js (Tab/Shift+Tab focus cycling)</div>
        <div class="file">DialogComponent.jsx (React component)</div>
      </div>

      <p><strong>Key Insight:</strong> Modern React separates concerns into hooks. Paradise validates the complete pattern across all files.</p>
    </section>

    <section class="demo-section">
      <h2>üé® Working Demo</h2>
      <p>This dialog implementation uses React hooks split across 3 files:</p>

      <button id="demo-trigger" style="padding: 12px 24px; font-size: 16px; cursor: pointer;">
        Open Dialog (React Hooks)
      </button>

      <div id="demo-dialog-overlay" class="dialog-overlay" role="presentation">
        <div id="demo-dialog"
             role="dialog"
             aria-modal="true"
             aria-labelledby="demo-dialog-title">
          <div class="dialog-header">
            <h2 id="demo-dialog-title">React Dialog with Hooks</h2>
            <button class="dialog-close" aria-label="Close dialog" id="demo-close">√ó</button>
          </div>
          <div>
            <p>This dialog demonstrates Paradise's ability to validate patterns using React hooks.</p>
            <p><strong>Try:</strong> Press Tab to cycle through focusable elements (focus stays trapped).</p>
            <p><strong>Try:</strong> Press Escape to close (focus returns to trigger button).</p>
          </div>
          <div style="margin-top: 16px; display: flex; gap: 12px; justify-content: flex-end;">
            <button id="demo-cancel" style="padding: 8px 16px;">Cancel</button>
            <button id="demo-confirm" style="padding: 8px 16px; background: #0066cc; color: white;">Confirm</button>
          </div>
        </div>
      </div>

      <div style="margin-top: 20px; padding: 16px; background: #f0f8ff; border-radius: 4px;">
        <strong>‚úÖ Features implemented across 3 files:</strong>
        <ul style="margin: 8px 0;">
          <li><strong>useDialog.js:</strong> Open/close state, focus restoration</li>
          <li><strong>useFocusTrap.js:</strong> Tab/Shift+Tab cycling, first/last element wrapping</li>
          <li><strong>DialogComponent.jsx:</strong> Combines hooks, Escape handler, ARIA attributes</li>
        </ul>
      </div>
    </section>

    <section class="analysis-section">
      <h2>üî¨ Analysis Comparison</h2>

      <div class="analysis-comparison">
        <div class="analysis-box traditional">
          <h3>‚ùå Traditional Tool (Component-Only)</h3>
          <p><strong>Analyzing: DialogComponent.jsx</strong></p>
          <pre><code>‚úì role="dialog" detected
‚úì aria-modal="true" present
‚úì aria-labelledby present
‚úì Escape handler detected
‚úó <span class="false-positive">NO FOCUS TRAP DETECTED</span>
‚úó <span class="false-positive">NO FOCUS RESTORATION</span>

<span class="false-positive">Issues: Missing focus management
WCAG 2.1.2, 2.4.3 violations</span></code></pre>

          <p><strong>Result:</strong> <span class="false-positive">2 FALSE POSITIVES</span></p>
          <p>The focus trap and restoration exist in the custom hooks but component-only analysis can't see them.</p>
        </div>

        <div class="analysis-box paradise">
          <h3>‚úÖ Paradise (Multi-Model + React Hooks)</h3>
          <p><strong>Analyzing: DialogComponent.jsx + useDialog.js + useFocusTrap.js</strong></p>
          <pre><code>‚úì role="dialog" detected
‚úì aria-modal="true" present
‚úì aria-labelledby present
‚úì Escape handler detected
‚úì <span class="true-result">FOCUS TRAP DETECTED</span>
  ‚Ä¢ useFocusTrap.js:
    - Tab key cycling
    - Shift+Tab key cycling
    - First/last element wrapping
‚úì <span class="true-result">FOCUS RESTORATION DETECTED</span>
  ‚Ä¢ useDialog.js:
    - Previous focus stored
    - Focus restored on close

<span class="true-result">Complete dialog pattern detected
Zero issues found</span></code></pre>

          <p><strong>Result:</strong> <span class="true-result">ACCURATE DETECTION</span></p>
          <p>Multi-model analysis with React hooks support sees the complete pattern.</p>
        </div>
      </div>
    </section>

    <section class="code-walkthrough">
      <h2>üíª Code Walkthrough</h2>

      <h3>File 1: useDialog.js (Custom Hook)</h3>
      <details class="code-sample">
        <summary>View Hook Source</summary>
        <pre><code>// Custom hook for dialog state management
function useDialog() {
  const [isOpen, setIsOpen] = useState(false);
  const [previousFocus, setPreviousFocus] = useState(null);

  const openDialog = useCallback(() => {
    // Store current focus for restoration
    setPreviousFocus(document.activeElement);
    setIsOpen(true);
  }, []);

  const closeDialog = useCallback(() => {
    setIsOpen(false);

    // Restore focus to trigger element
    if (previousFocus && previousFocus.focus) {
      previousFocus.focus();
    }
  }, [previousFocus]);

  return { isOpen, openDialog, closeDialog };
}

// ‚úÖ Paradise detects focus restoration in this hook</code></pre>
      </details>

      <h3>File 2: useFocusTrap.js (Custom Hook)</h3>
      <details class="code-sample">
        <summary>View Hook Source</summary>
        <pre><code>// Custom hook for focus trap implementation
function useFocusTrap(dialogRef, isOpen) {
  useEffect(() => {
    if (!isOpen || !dialogRef.current) return;

    const handleKeyDown = (event) => {
      if (event.key !== 'Tab') return;

      const focusables = dialogRef.current.querySelectorAll(
        'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
      );

      const firstElement = focusables[0];
      const lastElement = focusables[focusables.length - 1];

      if (event.shiftKey && document.activeElement === firstElement) {
        event.preventDefault();
        lastElement.focus();
      } else if (!event.shiftKey && document.activeElement === lastElement) {
        event.preventDefault();
        firstElement.focus();
      }
    };

    document.addEventListener('keydown', handleKeyDown);
    return () => document.removeEventListener('keydown', handleKeyDown);
  }, [isOpen, dialogRef]);
}

// ‚úÖ Paradise detects focus trap in this hook</code></pre>
      </details>

      <h3>File 3: DialogComponent.jsx (React Component)</h3>
      <details class="code-sample">
        <summary>View Component Source</summary>
        <pre><code>function DialogComponent({ trigger, title, children }) {
  const dialogRef = useRef(null);
  const { isOpen, openDialog, closeDialog } = useDialog();

  // Use focus trap hook
  useFocusTrap(dialogRef, isOpen);

  // Handle Escape key
  useEffect(() => {
    if (!isOpen) return;

    const handleEscape = (event) => {
      if (event.key === 'Escape') {
        closeDialog();
      }
    };

    document.addEventListener('keydown', handleEscape);
    return () => document.removeEventListener('keydown', handleEscape);
  }, [isOpen, closeDialog]);

  return (
    &lt;&gt;
      &lt;button onClick={openDialog}&gt;{trigger}&lt;/button&gt;

      {isOpen && (
        &lt;div className="overlay"&gt;
          &lt;div
            ref={dialogRef}
            role="dialog"
            aria-modal="true"
            aria-labelledby="dialog-title"
          &gt;
            &lt;h2 id="dialog-title"&gt;{title}&lt;/h2&gt;
            {children}
            &lt;button onClick={closeDialog}&gt;Close&lt;/button&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      )}
    &lt;/&gt;
  );
}

// ‚úÖ Paradise analyzes all 3 files together and validates
// the complete pattern including both custom hooks</code></pre>
      </details>
    </section>

    <section class="why-this-matters">
      <h2>üí° Why This Matters</h2>

      <div class="insight-box">
        <h3>Modern React Development Patterns</h3>
        <p>React developers separate concerns using custom hooks:</p>
        <ul>
          <li><strong>useDialog:</strong> State management and lifecycle</li>
          <li><strong>useFocusTrap:</strong> Reusable focus trap logic</li>
          <li><strong>useEscapeKey:</strong> Reusable keyboard handler</li>
          <li><strong>useFocusRestore:</strong> Focus restoration on unmount</li>
        </ul>

        <h3>The Hook-Based False Positive Problem</h3>
        <p>Component-only analysis misses logic in hooks:</p>
        <ul>
          <li>‚ùå Focus trap in useFocusTrap ‚Üí "Missing focus trap" warning</li>
          <li>‚ùå Focus restoration in useDialog ‚Üí "No restoration" warning</li>
          <li>‚ùå Keyboard handlers in hooks ‚Üí "No keyboard support" warning</li>
          <li>‚ùå Developers see constant false positives</li>
          <li>‚ùå They stop trusting the tool</li>
        </ul>

        <h3>Paradise's Hook-Aware Analysis</h3>
        <p>Multi-model architecture understands React patterns:</p>
        <ul>
          <li>‚úÖ Detects hooks used by components</li>
          <li>‚úÖ Follows hook dependencies (useEffect, useCallback, etc.)</li>
          <li>‚úÖ Validates complete pattern across component + hooks</li>
          <li>‚úÖ Zero false positives for proper hook architecture</li>
          <li>‚úÖ Developers trust the warnings they see</li>
        </ul>
      </div>
    </section>

    <section class="technical-details">
      <h2>‚öôÔ∏è How Paradise Achieves This</h2>

      <ol class="detection-steps">
        <li>
          <strong>React Pattern Detection</strong>
          <p>Paradise recognizes React patterns: hooks, components, JSX syntax</p>
        </li>
        <li>
          <strong>Hook Dependency Analysis</strong>
          <p>Traces useDialog and useFocusTrap imports in DialogComponent</p>
        </li>
        <li>
          <strong>Multi-File Parsing</strong>
          <p>Parses component + both hook files to ActionLanguageModel</p>
        </li>
        <li>
          <strong>Pattern Merging</strong>
          <p>Combines dialog pattern from component with focus management from hooks</p>
        </li>
        <li>
          <strong>Complete Validation</strong>
          <p>Validates dialog has focus trap (from useFocusTrap) and restoration (from useDialog)</p>
        </li>
        <li>
          <strong>Zero False Positives</strong>
          <p>Reports complete pattern, no warnings for proper hook architecture</p>
        </li>
      </ol>
    </section>

    <section class="comparison-with-tabs">
      <h2>üîÑ Comparison with Cross-File Tabs</h2>

      <table style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr style="background: #f5f5f5;">
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Aspect</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Cross-File Tabs</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Component Dialog</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding: 12px; border: 1px solid #ddd;"><strong>Architecture</strong></td>
            <td style="padding: 12px; border: 1px solid #ddd;">Vanilla JavaScript split across files</td>
            <td style="padding: 12px; border: 1px solid #ddd;">React hooks + component</td>
          </tr>
          <tr>
            <td style="padding: 12px; border: 1px solid #ddd;"><strong>File Count</strong></td>
            <td style="padding: 12px; border: 1px solid #ddd;">3 files (HTML + 2 JS)</td>
            <td style="padding: 12px; border: 1px solid #ddd;">3 files (2 hooks + component)</td>
          </tr>
          <tr>
            <td style="padding: 12px; border: 1px solid #ddd;"><strong>False Positives</strong></td>
            <td style="padding: 12px; border: 1px solid #ddd;">1 (missing keyboard handler)</td>
            <td style="padding: 12px; border: 1px solid #ddd;">2 (missing focus trap + restoration)</td>
          </tr>
          <tr>
            <td style="padding: 12px; border: 1px solid #ddd;"><strong>Paradise Solution</strong></td>
            <td style="padding: 12px; border: 1px solid #ddd;">Multi-file analysis</td>
            <td style="padding: 12px; border: 1px solid #ddd;">Hook-aware analysis</td>
          </tr>
          <tr>
            <td style="padding: 12px; border: 1px solid #ddd;"><strong>Key Demonstration</strong></td>
            <td style="padding: 12px; border: 1px solid #ddd;">Proves cross-file detection works</td>
            <td style="padding: 12px; border: 1px solid #ddd;">Proves React hooks support works</td>
          </tr>
        </tbody>
      </table>

      <p style="margin-top: 16px;"><strong>Combined Impact:</strong> Paradise handles both vanilla JavaScript code splitting AND modern React hook patterns with zero false positives.</p>
    </section>

    <section class="wcag-mapping">
      <h2>üìã WCAG Success Criteria</h2>
      <p>This implementation satisfies:</p>
      <ul class="wcag-list">
        <li>
          <strong>2.1.2 No Keyboard Trap (Level A)</strong>
          <p>Focus trap detected in useFocusTrap.js allows Tab navigation within dialog, Escape exits</p>
        </li>
        <li>
          <strong>2.4.3 Focus Order (Level A)</strong>
          <p>Focus management detected across useDialog.js (restoration) and useFocusTrap.js (cycling)</p>
        </li>
        <li>
          <strong>4.1.2 Name, Role, Value (Level A)</strong>
          <p>ARIA attributes detected in DialogComponent.jsx</p>
        </li>
      </ul>
    </section>

    <section class="resources">
      <h2>üìö Related Examples</h2>
      <ul>
        <li><a href="../cross-file-tabs/index.html">Cross-File Tabs</a> - Vanilla JS code splitting</li>
        <li><a href="../distributed-menu/index.html">Distributed Menu</a> - Menu pattern across 4 files</li>
        <li><a href="../../index.html">All Widget Patterns</a></li>
      </ul>
    </section>

    <nav class="demo-nav">
      <a href="../cross-file-tabs/index.html" class="nav-prev">‚Üê Previous: Cross-File Tabs</a>
      <a href="../../index.html" class="nav-home">üè† All Patterns</a>
      <a href="../distributed-menu/index.html" class="nav-next">Next: Distributed Menu ‚Üí</a>
    </nav>
  </div>

  <script src="useDialog.js"></script>
  <script src="useFocusTrap.js"></script>
  <script src="DialogComponent.js"></script>
</body>
</html>
